(this["webpackJsonppos-dev.com"]=this["webpackJsonppos-dev.com"]||[]).push([[8],{141:function(t,e,a){"use strict";a.r(e);var r=a(22),n=a(23),o=a(24),s=a(25),c=a(0),i=a.n(c),u=a(15),l=a(77),p=a(82),d=a(79),m=a.n(d),h=a(80),g=a(1),f=a(6),v=a(75),b=a(28),E=a(131),y=a(111),N=a.n(y),C=function(t){Object(s.a)(a,t);var e=Object(o.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).removeFromCart=function(t){console.log("removed from list"),n.props.removeFromCart(n.props.cart.cartItems,t,n.props.auth.user.cityCode,n.props.auth.user.userId)},n.onChangeQuantity=function(t){var e=t.target.name,a=t.target.value;n.props.updateCart(n.props.cart.cartItems,e,a,n.props.auth.user.cityCode,n.props.auth.user.userId)},n.state={},n}return Object(n.a)(a,[{key:"render",value:function(){var t=this;return console.log(this.props.cart),this.props.cart.isLoading?i.a.createElement("div",{className:"spinner"}):this.props.cart.cartItems.length>0?i.a.createElement("div",{className:"p-3"},i.a.createElement("table",{class:"table table-responsive"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"col"},"#"),i.a.createElement("th",{scope:"col"},"Product Name"),i.a.createElement("th",{scope:"col"},"Quantity"),i.a.createElement("th",{scope:"col"},"Action"))),i.a.createElement("tbody",null,this.props.cart.cartItems.map((function(e,a){return i.a.createElement("tr",{key:e.productId},i.a.createElement("td",null,a+1),i.a.createElement("td",null,e.productNameEn),i.a.createElement("td",null,i.a.createElement("input",{type:"number",name:e.productId,ref:function(e){return t.quantity=e},defaultValue:e.quantity,onChange:t.onChangeQuantity})),i.a.createElement("td",null,i.a.createElement("button",{className:"btn-red-sm",onClick:function(){return t.removeFromCart(e.productId)}},"remove")))}))))):i.a.createElement("div",{className:"card shodow p-4"},i.a.createElement("div",{className:"text-center"},i.a.createElement("h4",null,"No item added yet")))}}]),a}(c.Component),S=Object(u.b)((function(t){return{cart:t.cart.cart,auth:t.authorization.auth}}),{updateCart:function(t,e,a,r,n){return function(o){try{var s=t.slice();return s.forEach((function(t){t.productId===parseInt(e)&&(t.quantity=parseInt(a))})),localStorage.setItem("cart_pos_"+r,JSON.stringify(s)),o({type:g.q,payload:{isLoading:!1,hasError:!1,cartItems:s}})}catch(i){var c=i.toString();return Object(v.a)("website","actions/cartActions","updateCart function error",c,1,n),o({type:g.q,payload:{isLoading:!1,hasError:!0,cartItems:t}})}}},removeFromCart:function(t,e,a,r){return function(n){try{var o=t.slice().filter((function(t){return t.productId!==e}));return localStorage.setItem("cart_pos_"+a,JSON.stringify(o)),n({type:g.n,payload:{isLoading:!1,hasError:!1,cartItems:o}})}catch(c){var s=c.toString();return Object(v.a)("website","actions/cartActions","removeFromCart function error",s,1,r),n({type:g.n,payload:{isLoading:!1,hasError:!0,cartItems:t}})}}}})(C),I=a(12),w=a.n(I),L=a(126),O=a.n(L),j=function(t){Object(s.a)(a,t);var e=Object(o.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).componentDidMount=function(){window.scrollTo(0,0)},n.onChangeDate=function(t){n.setState({date:t})},n.onChangeProduct=function(t){n.setState({productId:t.value,loadStats:!1});var e=w.a.get("fth_pos_token");f.a.defaults.headers.common.Authorization="Bearer ".concat(e),f.a.get("/admin/procurement/product/".concat(t.value)).then((function(t){f.b&&console.log(t),n.setState({productStats:t.data.data,loadStats:!0})})).catch((function(t){f.b&&console.log(t.response)}))},n.onChangeUser=function(t){n.setState({userId:t.value})},n.onChangeQuantity=function(){n.setState({quantity:n.quantity.value})},n.onChangeAmount=function(){n.setState({amountGiven:n.amount.value})},n.onSubmitToCart=function(t){t.preventDefault(),n.setState({isCartLoading:!0}),n.props.addToCart(n.props.cart.cartItems,n.state.productId,n.state.quantity,n.props.auth.user.cityCode,n.props.auth.user.userId),setTimeout((function(){n.setState({isCartLoading:!1})}),500)},n.onSubmitProcurement=function(t){t.preventDefault();var e=n.state.date.getFullYear()+"-"+(n.state.date.getMonth()+1)+"-"+n.state.date.getDate();if(n.props.cart.cartItems.length>0&&""!==n.state.userId&&n.props.auth.user.cityId&&""!==n.state.amountGiven){var a={products:n.props.cart.cartItems,asigned_to:n.state.userId,amount_given:n.state.amountGiven,date:e,city_id:n.props.auth.user.cityId};f.a.post("/admin/procurement",a).then((function(t){f.b&&console.log(t),200===t.data.statusCode?(n.props.deleteCart(n.props.auth.user.cityCode),n.props.history.push({pathname:"/procurement",search:"?status=1"})):n.setState({isLoading:!1,errorApi:!0,errorApiMsg:"Something went wrong."})})).catch((function(t){f.b&&console.log(t.response),400===t.response.status?n.setState({isLoading:!1,errorApi:!0,errorApiMsg:t.response.data.message}):n.setState({isLoading:!1,errorApi:!0,errorApiMsg:"Something went wrong, Try Again!"})}))}else n.setState({errorApi:!0,errorApiMsg:"please fill all the information"})},n.getProductStats=function(){return i.a.createElement("div",{className:"card shadow rounded"},i.a.createElement("div",{className:"d-inline-flex"},n.state.productStats.map((function(t){return i.a.createElement("div",{className:"p-2 w-25"},i.a.createElement("h6",{className:"text-center"},i.a.createElement(O.a,{format:"D MMM"},t.createdAt)),i.a.createElement("hr",null),i.a.createElement("h6",{className:"text-center"},t.totalQuantity))}))))},n.state={date:new Date,userId:"",productId:"",quantity:"",amountGiven:"",errorApi:!1,errorApiMsg:"",loadStats:!1,isCartLoading:!1,productStats:{}},n.props.fetchProductsList(n.props.auth.user.cityCode,""),n.props.getUsers(),n}return Object(n.a)(a,[{key:"render",value:function(){var t=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,null),i.a.createElement("section",{className:"bg-light py-5 min-height-100"},i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"row justify-content-center"},i.a.createElement("div",{className:"col-12"},this.state.errorApi?i.a.createElement("div",{class:"alert alert-danger",role:"alert"},this.state.errorApiMsg):"",i.a.createElement("div",{className:"card shadow rounded"},i.a.createElement("div",{className:"p-4"},i.a.createElement("form",{onSubmit:this.onSubmitToCart},i.a.createElement("div",{className:"p-3"},i.a.createElement("div",{className:"form-group"},i.a.createElement(N.a,{onChange:this.onChangeDate,value:this.state.date}))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"form-group"},this.props.productsList.isLoading?"":i.a.createElement(E.a,{onChange:this.onChangeProduct,options:this.props.productsList.response.data})))),this.state.loadStats?i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"w-100 mx-auto my-4"},this.getProductStats())):"",i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{type:"number",name:"quantity",className:"form-control",id:"quantity",placeholder:"enter quantity",ref:function(e){return t.quantity=e},onChange:this.onChangeQuantity,required:!0}))),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"m-auto"},i.a.createElement("button",{type:"submit",className:"btn-green-sm"},"Add"))))))),i.a.createElement("div",{className:"card shahdow rounded mt-4"},this.props.cart.cartItems.isLoading||this.state.isCartLoading?"":i.a.createElement("div",{className:"pt-3"},i.a.createElement(S,null)),i.a.createElement("div",{className:"p-3"},i.a.createElement("form",{onSubmit:this.onSubmitProcurement},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"form-group"},this.props.users.isLoading?"":i.a.createElement(E.a,{onChange:this.onChangeUser,options:this.props.users.response.data}))),i.a.createElement("div",{className:"col"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{type:"number",name:"amount",className:"form-control",id:"amount",placeholder:"Enter Amount",ref:function(e){return t.amount=e},onChange:this.onChangeAmount,required:!0}))),i.a.createElement("div",{className:"col mx-auto"},i.a.createElement("div",{className:"m-auto"},i.a.createElement("button",{type:"submit",className:"btn-green-sm"},"Submit"))))))))))))}}]),a}(c.Component);e.default=Object(u.b)((function(t){return{auth:t.authorization.auth,users:t.authorization.users,productsList:t.products.productsList,cart:t.cart.cart}}),{createProcurementList:p.a,fetchProductsList:function(t,e){return function(){var a=Object(h.a)(m.a.mark((function a(r){return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.get("/productslist?city_code=".concat(t)).then((function(t){f.b&&console.log(t),r({type:g.k,payload:{isLoading:!1,hasError:!1,response:t.data}})})).catch((function(t){if(f.b&&console.log(t.response),400!==t.response.status){var a=JSON.stringify(t.response.data);Object(v.a)("website","actions/productActions.js","/api/v1/productlist api error",a,1,e)}r({type:g.k,payload:{isLoading:!1,hasError:!0,response:t.response.data}})}));case 2:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()},addToCart:function(t,e,a,r,n){return function(o){f.a.get("/cart/products/".concat(e)).then((function(n){f.b&&console.log(n);var s=t.slice(),c=!1;return s.length>0&&s.forEach((function(t){t.productId===e&&(c=!0,t.quantity=parseInt(a))})),c||s.push({productId:e,quantity:parseInt(a),productNameEn:n.data.data.productNameEn,productNameUr:n.data.data.productNameUr,unit:n.data.data.productUnit.unitEn}),localStorage.setItem("cart_pos_"+r,JSON.stringify(s)),o({type:g.a,payload:{isLoading:!1,hasError:!0,cartItems:s}})})).catch((function(e){f.b&&console.log(e.response);var a=JSON.stringify(e.response.data);return Object(v.a)("website","actions/cartActions","addToCart function error",a,1,n),o({type:g.a,payload:{isLoading:!1,hasError:!0,cartItems:t}})}))}},deleteCart:function(t){return function(e){return localStorage.removeItem("cart_pos_"+t),e({type:g.e,payload:{isLoading:!1,hasError:!1,cartItems:[]}})}},getUsers:b.a})(j)},75:function(t,e,a){"use strict";a.d(e,"b",(function(){return c})),a.d(e,"a",(function(){return i}));var r=a(1),n=a(6),o=a(27),s=a.n(o),c=function(t){return function(e){return e({type:r.b,payload:t})}},i=function(t,e,a,r,o,c){var i={platform:t,userid:c,location:e,title:a,description:r,flag:o};s.a.post("/api/v1/error/notification",i).then((function(t){return n.b&&console.log(t),!0})).catch((function(t){return n.b&&console.log(t.response),!1}))}},77:function(t,e,a){"use strict";var r=a(22),n=a(23),o=a(24),s=a(25),c=a(0),i=a.n(c),u=a(15),l=a(26),p=function(t){Object(s.a)(a,t);var e=Object(o.a)(a);function a(){return Object(r.a)(this,a),e.apply(this,arguments)}return Object(n.a)(a,[{key:"render",value:function(){return i.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-white"},i.a.createElement(l.b,{className:"navbar-brand",to:"/"},i.a.createElement("h4",null,"Farm To Home - ",this.props.auth.user.city)),i.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},i.a.createElement("span",{className:"navbar-toggler-icon"})),i.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},i.a.createElement("ul",{className:"navbar-nav ml-auto"},i.a.createElement("li",{className:"nav-item active"},i.a.createElement(l.b,{className:"nav-link",to:"/procurement",target:"_blank"},"Precurement")),i.a.createElement("li",{className:"nav-item dropdown"},i.a.createElement("button",{className:"btn-red-sm dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},this.props.auth.user.name),i.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},i.a.createElement(l.b,{to:"/",className:"dropdown-item"},"Logout"))))))}}]),a}(c.Component);e.a=Object(u.b)((function(t){return{auth:t.authorization.auth}}))(p)},82:function(t,e,a){"use strict";a.d(e,"a",(function(){return u})),a.d(e,"c",(function(){return l})),a.d(e,"b",(function(){return p}));var r=a(79),n=a.n(r),o=a(80),s=a(1),c=a(6),i=a(75),u=function(t,e,a,r,u){var l={amount_given:t,asigned_to:e,city_id:a,products:r};return function(){var t=Object(o.a)(n.a.mark((function t(e){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.post("/admin/procurement",l).then((function(t){c.b&&console.log(t),e({type:s.d,payload:{isLoading:!1,hasError:!1,response:t.data}})})).catch((function(t){if(c.b&&console.log(t.response),400!==t.response.status){var a=JSON.stringify(t.response.data);Object(i.a)("website","actions/productActions.js","/api/v1/category/products api error",a,1,u)}e({type:s.d,payload:{isLoading:!1,hasError:!0,response:t.response.data}})}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},l=function(t){return function(e){c.a.get("/admin/procurement").then((function(t){c.b&&console.log(t),e({type:s.h,payload:{isLoading:!1,hasError:!1,response:t.data}})})).catch((function(a){if(c.b&&console.log(a.response),400!==a.response.status){var r=JSON.stringify(a.response.data);Object(i.a)("website","actions/productActions.js","/api/v1/category/products api error",r,1,t)}e({type:s.h,payload:{isLoading:!1,hasError:!0,response:a.response.data}})}))}},p=function(t,e){return function(){var a=Object(o.a)(n.a.mark((function a(r){return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,c.a.get("/admin/procurement/".concat(t)).then((function(t){c.b&&console.log(t),r({type:s.g,payload:{isLoading:!1,hasError:!1,response:t.data}})})).catch((function(t){if(c.b&&console.log(t.response),400!==t.response.status){var a=JSON.stringify(t.response.data);Object(i.a)("website","actions/productActions.js","/api/v1/category/products api error",a,1,e)}r({type:s.g,payload:{isLoading:!1,hasError:!0,response:t.response.data}})}));case 2:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()}}}]);
//# sourceMappingURL=8.335992fb.chunk.js.map